(function(u,I,m,_){"use strict";var T;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(T||(T={}));var d;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(d||(d={}));var p;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(p||(p={}));const{sendBotMessage:N}=m.findByProps("sendBotMessage"),g=m.findByProps("getAPIBaseURL","get"),h=m.findByStoreName("ChannelStore");let y=[];const B=function(){y.push(I.registerCommand({name:"firstmessage",displayName:"firstmessage",description:"Tired of scrolling to first message?",displayDescription:"Tired of scrolling to first message?",type:p.CHAT,inputType:T.BUILT_IN_TEXT,applicationId:"-1",options:[{name:"user",displayName:"user",description:"Target user to get their first message in this server/dm",displayDescription:"Target user to get their first message in this server/dm",type:d.USER,required:!1},{name:"channel",displayName:"channel",description:"Target channel to get first message of",displayDescription:"Target channel to get first message of",type:d.CHANNEL,required:!1},{name:"send",displayName:"send",description:"Whether to send the resulting url",displayDescription:"Whether to send the resulting url",type:d.BOOLEAN,required:!1}],async execute(e,t){const s=e.find(function(n){return n.name==="user"})?.value,i=e.find(function(n){return n.name==="channel"})?.value,f=e.find(function(n){return n.name==="send"})?.value,a=t.guild.id,o=t.channel.id,l=t.channel.type??h.getChannel(h.getChannelId()).type===1;let r="https://discord.com/channels/";if(!s&&!i)if(l){const n=await A(o);r+=`@me/${o}/${n.id}`}else{const n=await c(a,null,o);r+=`${a}/${o}/${n.id}`}else if(s)if(l){const n=await A(o,s);r+=`@me/${o}/${n.id}`}else{const n=await c(a,s);r+=`${a}/${n.channel_id}/${n.id}`}else if(i){if(l)return N(o,"This combination cannot be used in dms!");const n=await c(a,null,i);r+=`${a}/${i}/${n.id}`}else{if(l)return N(o,"This combination cannot be used in dms!");const n=await c(a,s,i);r+=`${a}/${i}/${n.id}`}return f?{content:r}:_.url.openDeeplink(r)}}))},$=function(){for(const e of y)e()},c=async function(e,t,s){const i=t?`&author_id=${t}`:"",f=s?`&channel_id=${s}`:"";return(await g.get({url:`/guilds/${e}/messages/search`,query:`include_nsfw=true${i}${f}&sort_by=timestamp&sort_order=asc&offset=0`})).body.messages[0][0]},A=async function(e,t){const s=t?`&author_id=${t}`:"",i=t?"":"&min_id=0";return(await g.get({url:`/channels/${e}/messages/search`,query:`&sort_by=timestamp&sort_order=asc&offset=0${s}${i}`})).body.messages[0][0]};return u.onLoad=B,u.onUnload=$,u})({},vendetta.commands,vendetta.metro,vendetta.metro.common);
