(function(l,E,u,e,_,T,g,d,b,A,C){"use strict";const P="https://api.deeplx.org/translate";var D={translate:async function(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;try{if(i)return{source_lang:o,text:n};const t=await(await fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,source_lang:o,target_lang:a})})).json();if(t.code!==200)throw Error(`Failed to translate text from DeepL: ${t.message}`);return{source_lang:o,text:t.data}}catch(t){throw console.log(t),Error("Failed to translate text from DeepL")}}};const w=u.findByProps("openLazy","hideActionSheet"),N=u.findByProps("ActionSheetRow")?.ActionSheetRow??d.Forms.FormRow,m=u.findByStoreName("MessageStore"),F=u.findByStoreName("ChannelStore"),B=e.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:T.semanticColors.INTERACTIVE_NORMAL}});let h=[];function M(){return _.before("openLazy",w,function(n){let[o,a,i]=n;const t=i?.message;a!=="MessageLongPressActionSheet"||!t||o.then(function(H){const G=_.after("default",H,function(ee,J){e.React.useEffect(function(){return function(){G()}},[]);const p=b.findInReactTree(J,function(s){return s?.[0]?.type?.name==="ButtonRow"});if(!p)return;const Y=Math.max(p.findIndex(function(s){return s.props.message===e.i18n.Messages.MARK_UNREAD}),0),c=m.getMessage(t.channel_id,t.id);if(!c?.content&&!t.content)return;const y=c.id??t.id,Z=c.content??t.content,v=h.find(function(s){return Object.keys(s)[0]===y},"cache object"),S=v?"Revert":"Translate",I=S==="Translate"?g.getAssetIDByName("ic_locale_24px"):g.getAssetIDByName("ic_highlight"),q=async function(){const s=r.target_lang,f=S==="Translate",Q=await D.translate(c.content,null,s,!f);return e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...c,content:`${f?Q.text:v[y]} ${f?`\`[${s?.toLowerCase()}]\``:""}`,guild_id:F.getChannel(c.channel_id).guild_id},log_edit:!1}),f?h.unshift({[y]:Z}):h=h.filter(function(W){return W!==v},"cached data override"),w.hideActionSheet()};p.splice(Y,0,e.React.createElement(N,{label:`${S} Message`,icon:e.React.createElement(N.Icon,{source:I,IconComponent:function(){return e.React.createElement(e.ReactNative.Image,{resizeMode:"cover",style:B.iconComponent,source:I})}}),onPress:q}))})})})}var O={bulgarian:"BG",czech:"CS",danish:"DA",german:"DE",greek:"EL",english:"EN",spanish:"ES",estonian:"ET",finnish:"FI",french:"FR",hungarian:"HU",indonesian:"ID",italian:"IT",japanese:"JA",korean:"KO",lithuanian:"LT",latvian:"LV",norwegian:"NO",dutch:"NL",polish:"PL",portuguese:"PT",romanian:"RO",russian:"RU",slovak:"SK",slovenian:"SL",swedish:"SV",turkish:"TR",ukrainian:"UK","chinese-simplified":"ZH"};const{FormRow:L}=d.Forms,{ScrollView:$}=e.ReactNative;function j(){A.useProxy(r);const[n,o]=e.React.useState("");return e.React.createElement($,{style:{flex:1}},e.React.createElement(d.Search,{style:{padding:15},placeholder:"Search Language",onChangeText:function(a){o(a)}}),Object.entries(O).filter(function(a){let[i,t]=a;return i.includes(n)}).map(function(a){let[i,t]=a;return e.React.createElement(L,{label:i,trailing:function(){return e.React.createElement(L.Arrow,null)},onPress:function(){r.target_lang!=t&&(r.target_lang=t,C.showToast(`Saved ToLang to ${i}`,g.getAssetIDByName("check")))}})}))}const{ScrollView:k,Text:U}=e.ReactNative,{FormRow:R}=d.Forms,V=e.stylesheet.createThemedStyleSheet({subheaderText:{color:T.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:14}});function z(){const n=e.NavigationNative.useNavigation();return A.useProxy(r),e.React.createElement(k,null,e.React.createElement(R,{label:"Translate to",subLabel:r.target_lang?.toLowerCase(),leading:e.React.createElement(R.Icon,{source:g.getAssetIDByName("ic_activity_24px")}),trailing:function(){return e.React.createElement(R.Arrow,null)},onPress:function(){return n.push("VendettaCustomPage",{title:"Translate to",render:j})}}),e.React.createElement(U,{style:V.subheaderText,onPress:function(){return e.url.openURL("https://github.com/aeongdesu/vdplugins")}},`Build: (${E.manifest.hash.substring(0,7)})`))}const r=E.storage;r.target_lang??="EN";let x=[];var K={onLoad:function(){x.push(M())},onUnload:function(){for(const n of x)n()},settings:z};return l.default=K,l.settings=r,Object.defineProperty(l,"__esModule",{value:!0}),l})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta.storage,vendetta.ui.toasts);
