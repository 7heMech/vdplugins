(function(s,c,d,f,m,a,y){"use strict";const h=d.findByProps("sendBotMessage"),o=function(e,t){return h.sendBotMessage(e,t)},n=m.useProxy(f.storage);var b=c.registerCommand({name:"osu-profile",displayName:"osu-profile",description:"Display statistics of a user",displayDescription:"Display statistics of a user",options:[{name:"username",displayName:"username",description:"Specify a username, ID, or URL of the player",displayDescription:"Specify a username, ID, or URL of the player",required:!1,type:3}],applicationId:"",inputType:1,type:1,execute:async function(e,t){if(!n.clientID||!Number.isInteger(n.clientID)||!n.clientSecret)return o(t.channel.id,"Please set apiv2 configuration in plugin settings.")}});const p={beatmap_official:/https?:\/\/osu.ppy.sh\/beatmapsets\/[0-9]+\#(osu|taiko|fruits|mania)\/([0-9]+)/,beatmap_old:/https?:\/\/(osu|old).ppy.sh\/b\/([0-9]+)/,beatmap_alternate:/https?:\/\/osu.ppy.sh\/beatmaps\/([0-9]+)/,beatmap_old_alternate:/https?:\/\/(osu|old).ppy.sh\/p\/beatmap\?b=([0-9]+)/},g=async function(){if(n.accessData.token&&n.accessData.expires_in>Date.now())return n.accessData.token;const{access_token:e,expires_in:t}=await fetch("https://osu.ppy.sh/oauth/token",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({client_id:n.clientID,client_secret:n.clientSecret,grant_type:"client_credentials",scope:"public"})}).then(function(i){return i.json()});return n.accessData={token:e,expires_in:t*1e3+Date.now()},e},D=async function(e){return await fetch(e,{method:"GET",headers:{"content-type":"application/json",authorization:`Bearer ${await g()}`}}).then(function(t){return t.json()})},v=async function(e){if(!Number.isInteger(e))for(const i in p){const r=e.match(p[i]);r&&(e=r[r.length-1])}const t=await D(`https://osu.ppy.sh/api/v2/beatmaps/${e}`);return{id:t.id,setid:t.beatmapset_id,title:t.beatmapset.title,artist:t.beatmapset.artist,status:t.beatmapset.status,version:t.version,diffrating:t.difficulty_rating,bpm:t.bpm}};var I=c.registerCommand({name:"osu-beatmap",displayName:"osu-beatmap",description:"Sends an info message about the specified beatmap",displayDescription:"Sends an info message about the specified beatmap",options:[{name:"id",displayName:"id",description:"Specify a beatmap URL or ID",displayDescription:"Specify a beatmap URL or ID",required:!0,type:3}],applicationId:"",inputType:1,type:1,execute:async function(e,t){if(!n.clientID||!Number.isInteger(n.clientID)||!n.clientSecret)return o(t.channel.id,"Please set apiv2 configuration in plugin settings.");const i=await v(e[0]);return o(t.channel.id,i.title)}});let l=[b,I];const{ScrollView:_}=a.ReactNative,{FormSection:S,FormInput:u}=y.Forms;function N(){return a.React.createElement(_,{style:{flex:1}},a.React.createElement(S,{title:"apiv2 configuration",titleStyleType:"no_border"},a.React.createElement(u,{title:"Client ID",value:n.clientID,placeholder:"00000",onChangeText:function(e){return n.clientID=e}}),a.React.createElement(u,{title:"Client Secret",value:n.clientSecret,placeholder:"asdfghjkl",onChangeText:function(e){return n.clientSecret=e}})))}var R={onLoad:function(){return l},onUnload:function(){for(const e of l)e()},settings:N};return s.default=R,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.commands,vendetta.metro,vendetta.plugin,vendetta.storage,vendetta.metro.common,vendetta.ui.components);
